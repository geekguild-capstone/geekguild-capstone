<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta charset="UTF-8">
    <title>Edit</title>
</head>
<body>
<h1>Hello <span th:text="${user.username}"></span></h1>


<div>
    <button class="upload">Upload file</button>
</div>
<div>
    <img th:src="${user.image}" width="200" height="200" class="logo"/>
</div>

<!-- Add a form to submit the uploaded image URL -->
<form id="imageForm" method="post" action="/profile/upload">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
    <input type="hidden" name="fileURL" id="fileURLInput"/>
</form>




<h1>EDIT YOUR PROFILE</h1>

<h3>Profile Photo</h3>

<form id="edit-user-form" class="inline-form" th:action="@{/profile/{id}/edit(id=${user.getId()})}" th:method="post">
    <label for="username">Username</label>
    <input id="username" name="username" th:value="${user.username}"/>
    <br>
    <label for="email">Email</label>
    <input id="email" name="email" th:value="${user.email}"/>
    <br>
    <!--  <label for="about_me">About Me</label>-->
    <!--  <input id="about_me" name="about_me" th:value="${user.aboutMe}" />-->
    <!--  <br>-->
    <!--  <label for="hobbies">Hobbies</label>-->
    <!--  <input id="hobbies" name="hobbies" th:value="${user.hobbies}" />-->
    <!--  <br>-->
    <!--  <label for="languages">Languages</label>-->
    <!--  <input id="languages" name="languages" th:value="${user.languages}" />-->
    <!--  <br>-->
    <!--  <label for="social_linked_in">Social Media(LinkedIn)</label>-->
    <!--  <input id="social_linked_in" name="social_linked_in" th:value="${user.socialLinkedIn}" />-->
    <!--  <br>-->
    <!--  <label for="social_git">Social Media(Git)</label>-->
    <!--  <input id="social_git" name="social_git" th:value="${user.socialGit}" />-->
    <!--  <br>-->
    <!--  <label for="social_face_book">Social Media(Facebook)</label>-->
    <!--  <input id="social_face_book" name="social_face_book" th:value="${user.socialFacebook}" />-->
    <br>
    <!--  <button type="submit">Save Profile</button>-->

    <button id="edit-btn" class="waves-effect waves-light btn">Save Edit</button>
</form>

<!-- Delete Task Form -->

<form id="delete-user-form" class="inline-form" th:action="@{/profile/{id}/delete(id=${user.getId()})}" th:method="post">
    <button id="delete-btn" class="waves-effect waves-light btn">Delete Profile</button>
</form>


<!--<script>-->

<!--    $(document).ready(function() {-->
<!--        $('#delete-btn').on('click', function(event) {-->
<!--            event.preventDefault();-->

<!--            if (confirm('Are you sure you want to delete your profile?')) {-->
<!--                $('#delete-user-form').submit();-->
<!--            }-->
<!--        });-->
<!--    });-->


<script src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>
<script>
    const button = document.querySelector('.upload');
    const image = document.querySelector('.logo');

    button.addEventListener('click', () => {
        const apiKey = 'APaRx6LcnR9W7kXg7lQw2z';
        const client = filestack.init(apiKey);
        const options = {
            onUploadDone: (uploadResponse) => {
                console.log('onUploadDone', uploadResponse);
                const fileURL = uploadResponse.filesUploaded[0].url;
                image.setAttribute('src', fileURL);

                // Submit the fileURL to the server via the form
                const fileURLInput = document.querySelector('#fileURLInput');
                fileURLInput.value = fileURL;
                document.getElementById('imageForm').submit();
            }
        };
        client.picker(options).open();
    });



</script>
</body>
</html>