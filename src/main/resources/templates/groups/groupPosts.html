
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Post</title>
    <!-- Add the necessary CSS libraries (e.g., Font Awesome) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!--CUSTOM CSS -->
    <link rel="stylesheet" href="/css/postCard.css">
</head>

<body>
<div th:each="post, postIndex : ${groupPosts}">
    <div class="post-card">

        <div class="edit-icons">
            <i class="far fa-edit edit-icon" onclick="editPost(event)"></i>
            <i class="far fa-times-circle delete-icon" onclick="deletePost(event)"></i>
        </div>


        <div class="user-profile">
            <img th:src="${post.user.image}" alt="User Profile Image">
            <div th:text="${post.user.firstname + ' ' + post.user.lastname}" class="username"></div>
        </div>
        <div class="post-content-container">
            <div class="post-content">
                <p th:text="${post.body}"></p>

                <!-- Move the .post-image div here, within .post-content -->
                <div class="post-image">
                    <img width="100%" th:src="${post.image}">
                </div>
            </div>

            <div class="interactions">
                <button onmouseover="showLikeEmojis(this)" onmouseout="hideLikeEmojis(this)">
                    <i class="far fa-thumbs-up"></i>Like
                </button>
                <div class="like-emojis" style="display: none;">
                    <span class="like-emoji" onclick="likeAction('üëç')">üëç</span>
                    <span class="like-emoji" onclick="likeAction('‚ù§Ô∏è')">‚ù§Ô∏è</span>
                    <span class="like-emoji" onclick="likeAction('üòÇ')">üòÇ</span>
                </div>

                <button class="comment-button" onclick="toggleCommentBox(this)">
                    <i class="far fa-comment-dots"></i>Comment
                </button>
                <button class="share-button">
                    <i class="fas fa-envelope"></i>Message <!-- Updated text and icon -->
                </button>
            </div>
        </div>

        <div class="comment-box">
            <!-- Use a <form> element to wrap the comment input and button -->
            <form th:action="@{/group/{groupId}/comment(groupId=${group.id})}" th:object="${comment}" method="post">
                <input type="hidden" name="post.id" th:value="${post.id}" />
                <input type="hidden" name="user.id" th:value="${user.id}" />
                <input type="text" th:field="*{text}" id="comment-input" placeholder="Add a comment..." />
                <button class="submit-comment-btn" type="submit">Submit</button>
            </form>
        </div>

        <div class="comments-section" id="comments-section">
            <!-- Display comments here (if available) -->
            <ul>
                <li th:each="comment : ${groupPostComments[postIndex.index]}">
                    <p th:text="${comment.text}"></p>
                    <p th:text="${comment.user.firstname + ' ' + comment.user.lastname}"></p>
                </li>
            </ul>
        </div>
    </div>
</div>


<script>
    function toggleCommentBox(button) {
        const postCard = button.closest('.post-card');
        const commentBox = postCard.querySelector('.comment-box');

        // Toggle the visibility of the comment box
        if (commentBox.style.display === 'none') {
            commentBox.style.display = 'block';
        } else {
            commentBox.style.display = 'none';
        }
    }

    function submitComment(event) {
        const button = event.target;
        const postCard = button.closest('.post-card');
        const commentInput = postCard.querySelector('#comment-input');
        const commentsSection = postCard.querySelector('.comments-section');

        const commentText = commentInput.value.trim();
        if (commentText !== '') {
            // Create a new comment element and append it to the comments section
            const newComment = document.createElement('div');
            newComment.classList.add('comment');

            // User profile image (replace with actual image source)
            const userProfileImg = document.createElement('img');
            userProfileImg.src = 'https://via.placeholder.com/24';
            userProfileImg.alt = 'User Profile Image';

            // User profile username (replace with actual username)
            const userProfileUsername = document.createElement('div');
            userProfileUsername.classList.add('username');
            userProfileUsername.textContent = 'John Doe';

            // Comment content
            const commentContent = document.createElement('p');
            commentContent.textContent = commentText;

            // Horizontal line to separate comments
            const hr = document.createElement('hr');

            // Append the elements to the comment container
            newComment.appendChild(userProfileImg);
            newComment.appendChild(userProfileUsername);
            newComment.appendChild(commentContent);
            newComment.appendChild(hr);

            commentsSection.appendChild(newComment);

            // Clear the comment input field
            commentInput.value = '';

            // Auto-close the comment box after submission
            const commentBox = postCard.querySelector('.comment-box');
            commentBox.style.display = 'none';
        }

    }

    function showLikeEmojis(button) {
        const postCard = button.closest('.post-card');
        const likeEmojis = postCard.querySelector('.like-emojis');
        likeEmojis.style.display = 'block';
    }

    function hideLikeEmojis(button) {
        const postCard = button.closest('.post-card');
        const likeEmojis = postCard.querySelector('.like-emojis');
        likeEmojis.style.display = 'none';
    }
</script>
</body>
</html>

